# The LaTeX CGI Server

## Introduction

The LaTeX CGI server (currently running at [latexcgi.xyz](https://latexcgi.xyz)) accepts LaTeX documents via an HTTP POST request
and returns a PDF document or log file in the case of error.

It is written as a perl script accepting the post requests via cgi-bin access in an apache HTTP server.

## HTTP Requests

The document must be supplied by an HTTP POST multipart/form-data request.
Any other HTTP request is rejected. The allowed form fields are defined below.
If the form contains unexpected fields, the whole submission is rejected.

## Form Fields

 * engine
 
   This field is optional, but if supplied must be one of `lulatex`, `pdflatex`, `xelatex`, `uplatex`, `platex`.
   The default is `pdflatex`.
 * bibcmd
 
   This field is optional, but if supplied must be one of `biber`, `bibtex`, `pbibtex`, `bibtex8`.
   It defaults to empty unless the log of the first run from LaTeX has a biblatex message saying to run biber or bibtex, or if there is a `No file document.bbl` message.
 * filename[]
 
   There must be at least one of these parameters, each specifying a filename.
   There must be one `filename[]` parameter with value `document.tex`
 * filecontents[]
 
   These multi-line fields contain the contents of the supplied files.
   There must be the same number of `filecontents[]` parameters as `filename[]` parameters.
 * _makeindex_
 
   It is planned to have parameters controlling indexing but currently not implemented.
   The `imakeidx` package can be used to call `makeindex` from with LaTeX.


## The learnlatex Comment Interface.
Usually the form for the HTTP submission is generated by the  `runlatex`  JavaScript This constructs the parameters from one or more HTML `<pre>` elements, which may be controlled using comments of the form
```
% !TEX  ... keyword
```

The comments are checked in a case insensitive way, any text other than the final keyword is ignored, so the following are all equivalent
```
% !TEX lualatex
%  !TeX  program = LuaLaTeX
% !tex  ignored commend lualatex
```

The known keywords are

* `lulatex`, `pdflatex`, `xelatex`, `uplatex`, `platex`

 The `engine` parameter is set to the specified keyword (lowercase).
 
 If this is not used then `engine` is set to `pdflatex`, unless `fontspec` appears in the example, in which case it is set to `xelatex`
 
 * `biber`, `bibtex`, `pbibtex`, `bibtex8`
 
  The `bibcmd` parameter is set to the specified keyword (lowercase).
  
  If this is not used the `bibcmd` parameter is not set and bibtex or biber may be chosen automatically as described above.
  
 * _indexcmd_
 
 If the indexcmd parameter is implemented on the server, a matching comment syntax will be added here.
 
